{% extends "base.html" %}

{% block title %}{{ _("Process Article") }} - {{ super() }}{% endblock %}

{% block scripts %}
{{ super() }}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const articleTypeSelect = document.getElementById('article-type');
        const dissectSectionsDiv = document.getElementById('dissect-sections');

        const sections = {
            "News": [
                "What is this about?",
                "Any change to existing feature/item?",
                "Brief background of the news.",
                "When is it expected to come?",
                "What value it might add?",
                "Competitor advantage."
            ],
            "Research": [
                "What is the research about?",
                "What are the key findings?",
                "What are the implications of the research?",
                "What are the limitations of the research?"
            ],
            "Analysis": [
                "What is being analyzed?",
                "What are the main points of the analysis?",
                "What are the conclusions of the analysis?",
                "What are the recommendations?"
            ],
            "How-to": [
                "What is the goal of this how-to?",
                "What are the prerequisites?",
                "What are the steps involved?",
                "What is the expected outcome?"
            ]
        };

        articleTypeSelect.addEventListener('change', function() {
            const selectedType = this.value;
            const selectedSections = sections[selectedType] || [];

            dissectSectionsDiv.innerHTML = '';

            selectedSections.forEach(sectionTitle => {
                const sectionDiv = document.createElement('div');
                sectionDiv.classList.add('mb-3');

                const label = document.createElement('label');
                label.classList.add('form-label');
                label.textContent = sectionTitle;

                const textArea = document.createElement('textarea');
                textArea.classList.add('form-control');
                textArea.rows = 3;

                sectionDiv.appendChild(label);
                sectionDiv.appendChild(textArea);

                dissectSectionsDiv.appendChild(sectionDiv);
            });
        });
    });
</script>
{% endblock %}
{% block content %}
<div class="container mt-4">
    <h1 class="mb-4">{{ _("Process Article") }}: {{ article.title }}</h1>

    <div class="row">
        <div class="col-md-8">
            <h2>{{ _("Original Content") }}</h2>
            <p>{{ article.content }}</p>
        </div>
        <div class="col-md-4">
            <h2>{{ _("Curation Actions") }}</h2>
            <div class="d-grid gap-2">
                <div class="mb-3">
                    <label for="article-type" class="form-label">{{ _("Article Type") }}</label>
                    <select class="form-select" id="article-type">
                        <option selected>{{ _("Select Article Type") }}</option>
                        <option value="News">{{ _("News") }}</option>
                        <option value="Research">{{ _("Research") }}</option>
                        <option value="Analysis">{{ _("Analysis") }}</option>
                        <option value="How-to">{{ _("How-to") }}</option>
                    </select>
                </div>

                <div id="dissect-sections"></div>

                <button class="btn btn-primary" id="save-dissect-btn">{{ _("Save Dissection") }}</button>
                <button class="btn btn-secondary" id="rewrite-btn">{{ _("Re-write") }}</button>
                <button class="btn btn-success" id="approve-btn">{{ _("Approve") }}</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}